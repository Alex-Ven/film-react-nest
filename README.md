# ğŸ¬ Films â€” Ğ±ÑĞºĞµĞ½Ğ´ Ğ¾Ğ½Ğ»Ğ°Ğ¹Ğ½-ĞºĞ¸Ğ½Ğ¾Ñ‚ĞµĞ°Ñ‚Ñ€Ğ°

> NestJS + PostgreSQL / MongoDB | Ğ“Ğ¸Ğ±ĞºĞ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° | Ğ‘Ñ€Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ±Ğ¸Ğ»ĞµÑ‚Ğ¾Ğ²

ĞŸÑ€Ğ¾ĞµĞºÑ‚ Films â€” ÑÑ‚Ğ¾ Ğ±ÑĞºĞµĞ½Ğ´ Ğ´Ğ»Ñ Ğ¾Ğ½Ğ»Ğ°Ğ¹Ğ½-ÑĞµÑ€Ğ²Ğ¸ÑĞ° Ğ±Ñ€Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğ±Ğ¸Ğ»ĞµÑ‚Ğ¾Ğ² Ğ² ĞºĞ¸Ğ½Ğ¾Ñ‚ĞµĞ°Ñ‚Ñ€.  
ĞĞ½ Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶Ğ¸Ğ²Ğ°ĞµÑ‚ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñƒ Ñ **PostgreSQL** Ğ¸Ğ»Ğ¸ **MongoDB**, Ğ² Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Ğ¾Ñ‚ Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ğ¾Ğ¹ Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ.

## ğŸ“‹ Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚Ğ¸

- ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ ÑĞ¿Ğ¸ÑĞºĞ° Ñ„Ğ¸Ğ»ÑŒĞ¼Ğ¾Ğ²
- ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ñ€Ğ°ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ñ Ğ¿Ğ¾ ID Ñ„Ğ¸Ğ»ÑŒĞ¼Ğ°
- Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ñ„Ğ¸Ğ»ÑŒĞ¼Ğ¾Ğ² Ğ¸ ÑĞµĞ°Ğ½ÑĞ¾Ğ²
- Ğ‘Ñ€Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ±Ğ¸Ğ»ĞµÑ‚Ğ¾Ğ²
- ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ° Ğ½ĞµÑĞºĞ¾Ğ»ÑŒĞºĞ¸Ñ… Ğ´Ñ€Ğ°Ğ¹Ğ²ĞµÑ€Ğ¾Ğ² Ğ‘Ğ”
- ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†/ĞºĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸Ğ¹
- Ğ—Ğ°Ğ¿ÑƒÑĞº Ñ‡ĞµÑ€ĞµĞ· Docker

---

## ğŸ§© ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

ĞŸÑ€Ğ¾ĞµĞºÑ‚ Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ğ½ Ñ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸ĞµĞ¼ Ğ³Ğ¸Ğ±ĞºĞ¾Ğ¹ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ñ‹:

| Ğ¡Ğ»Ğ¾Ğ¹ | Ğ§Ñ‚Ğ¾ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ |
|------|------------------|
| DTO | `FilmDto`, `ScheduleDto`, `OrderDto` |
| ĞœĞ°Ğ¿Ğ¿ĞµÑ€Ñ‹ | `mapFilmToDto`, `mapScheduleToDto` |
| Ğ ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ¸ | `FilmsRepository`, `OrderRepository` |
| Ğ‘Ğ°Ğ·Ğ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… | PostgreSQL (TypeORM) Ğ¸Ğ»Ğ¸ MongoDB (Mongoose) |
| ĞšĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»Ğ»ĞµÑ€Ñ‹ | `FilmsController`, `OrderController` |
| Ğ¡ĞµÑ€Ğ²Ğ¸ÑÑ‹ | `FilmsService`, `OrderService` |

---

## ğŸ”§ Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ¸ Ğ·Ğ°Ğ¿ÑƒÑĞº

### 1. ĞšĞ»Ğ¾Ğ½Ğ¸Ñ€ÑƒĞ¹Ñ‚Ğµ Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ¹

```bash
git clone https://github.com/Alex-Ven/film-react-nest.git
cd film-react-nest
```

### 2. Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚Ğµ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸

```bash
npm install
```

Ğ¸Ğ»Ğ¸ Ñ‡ĞµÑ€ĞµĞ· Docker Compose:

```bash
docker-compose up -d
```

---

## ğŸ³ Ğ—Ğ°Ğ¿ÑƒÑĞº Ñ‡ĞµÑ€ĞµĞ· Docker

### A. ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹Ñ‚Ğµ `.env`

```env
# .env
DATABASE_DRIVER=postgres
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_USER=prac
POSTGRES_PASSWORD=prac
POSTGRES_DATABASE=prac
```

### B. Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚Ğµ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ñ‹

```bash
docker-compose up -d
```

> Ğ­Ñ‚Ğ¾ Ğ·Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚:
- `film-backend` â€” Ğ²Ğ°Ñˆ NestJS-Ğ±ÑĞºĞµĞ½Ğ´
- `prac-postgres` â€” PostgreSQL
- `film-mongo` â€” MongoDB (ĞµÑĞ»Ğ¸ Ğ²ĞºĞ»ÑÑ‡ĞµĞ½Ğ°)

---

## ğŸ”„ ĞŸĞµÑ€ĞµĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğ´Ñ€Ğ°Ğ¹Ğ²ĞµÑ€Ğ°

Ğ˜Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ `DATABASE_DRIVER` Ğ² `.env`:

```env
DATABASE_DRIVER=postgres
```

Ğ¸Ğ»Ğ¸

```env
DATABASE_DRIVER=mongodb
```

> ĞŸĞ¾ÑĞ»Ğµ ÑÑ‚Ğ¾Ğ³Ğ¾ Ğ¿ĞµÑ€ĞµĞ·Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚Ğµ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ñ‹:

```bash
docker-compose down
docker-compose up -d
```

---

## ğŸŒ Ğ”Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹Ğµ API-ÑĞ½Ğ´Ğ¿Ğ¾Ğ¸Ğ½Ñ‚Ñ‹

| ĞœĞµÑ‚Ğ¾Ğ´ | ĞŸÑƒÑ‚ÑŒ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ |
|-------|------|----------|
| GET   | `/api/afisha/films` | ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ ÑĞ¿Ğ¸ÑĞ¾Ğº Ñ„Ğ¸Ğ»ÑŒĞ¼Ğ¾Ğ² |
| GET   | `/api/afisha/films/:id/schedule` | ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ñ€Ğ°ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ Ğ´Ğ»Ñ Ñ„Ğ¸Ğ»ÑŒĞ¼Ğ° |
| POST  | `/api/afisha/films` | Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ½Ğ¾Ğ²Ñ‹Ğ¹ Ñ„Ğ¸Ğ»ÑŒĞ¼ |
| POST  | `/order` | Ğ—Ğ°Ğ±Ñ€Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ±Ğ¸Ğ»ĞµÑ‚Ñ‹ |

---

## ğŸ“¦ ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ°: Ğ±Ñ€Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ±Ğ¸Ğ»ĞµÑ‚Ğ°

```json
POST /order HTTP/1.1
Content-Type: application/json

{
  "email": "user@example.com",
  "phone": "+79876543210",
  "tickets": [
    {
      "film": "0e33c7f6-27a7-4aa0-8e61-65d7e5effecf",
      "session": "f2e429b0-685d-41f8-a8cd-1d8cb63b99ce",
      "row": 1,
      "seat": 2
    }
  ]
}
```

âœ… ĞÑ‚Ğ²ĞµÑ‚:

```json
{
  "total": 1,
  "items": [
    {
      "film": "0e33c7f6-27a7-4aa0-8e61-65d7e5effecf",
      "session": "f2e429b0-685d-41f8-a8cd-1d8cb63b99ce",
      "row": 1,
      "seat": 2,
      "id": "1:2"
    }
  ]
}
```

---

## ğŸ§ª Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ‡ĞµÑ€ĞµĞ· Postman

Ğ’ Ğ¿Ğ°Ğ¿ĞºĞµ `postman/` Ğ²Ñ‹ Ğ½Ğ°Ğ¹Ğ´Ñ‘Ñ‚Ğµ:
- ĞšĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸Ñ `film.postman.json`
- ĞŸĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ ÑÑ€ĞµĞ´Ñ‹ Ğ´Ğ»Ñ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ (`test` environment)

---

## ğŸ—‚ Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°

```
src/
â”œâ”€â”€ films/
â”‚   â”œâ”€â”€ dto/
â”‚   â”‚   â””â”€â”€ films.dto.ts
â”‚   â”‚   â””â”€â”€ films.mapper.ts
â”‚   â”œâ”€â”€ entities/
â”‚   â”‚   â””â”€â”€ film.entity.ts         â† TypeORM
â”‚   â”‚   â””â”€â”€ schedule.entity.ts     â† TypeORM
â”‚   â”‚   â””â”€â”€ film.mongo-entity.ts   â† Mongoose
â”‚   â”œâ”€â”€ repository/
â”‚   â”‚   â””â”€â”€ films.typeorm-repository.ts
â”‚   â”‚   â””â”€â”€ films.mongo-repository.ts
â”‚   â”‚   â””â”€â”€ films.repository.interface.ts
â”‚   â”œâ”€â”€ service/
â”‚   â”‚   â””â”€â”€ films.service.ts
â”‚   â””â”€â”€ controller/
â”‚       â””â”€â”€ films.controller.ts

â”œâ”€â”€ order/
â”‚   â”œâ”€â”€ dto/
â”‚   â”‚   â””â”€â”€ order.dto.ts
â”‚   â”œâ”€â”€ repository/
â”‚   â”‚   â””â”€â”€ order.typeorm-repository.ts
â”‚   â”‚   â””â”€â”€ order.mongo-repository.ts
â”‚   â”‚   â””â”€â”€ order.repository.interface.ts
â”‚   â”œâ”€â”€ service/
â”‚   â”‚   â””â”€â”€ order.service.ts
â”‚   â””â”€â”€ controller/
â”‚       â””â”€â”€ order.controller.ts

â””â”€â”€ config/
    â””â”€â”€ database.module.ts
```

---

## ğŸ“ SQL / Mongoose

Ğ’Ñ‹ Ğ¼Ğ¾Ğ¶ĞµÑ‚Ğµ Ğ½Ğ°Ğ¹Ñ‚Ğ¸ SQL-Ñ„Ğ°Ğ¹Ğ»Ñ‹ Ğ² Ğ¿Ğ°Ğ¿ĞºĞµ:

```
test/
â”œâ”€â”€ prac.init.sql
â”œâ”€â”€ prac.films.sql
â””â”€â”€ prac.schedules.sql
```

---

## ğŸ›  Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼Ñ‹Ğµ Ñ‚ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ğ¸

| Ğ¢ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ñ | Ğ’ĞµÑ€ÑĞ¸Ñ |
|-----------|--------|
| NestJS    | ^10.0.0 |
| TypeORM   | ^0.3.19 |
| PostgreSQL | 16-alpine |
| Mongoose  | ^8.4.4 |
| Node.js   | 20-alpine |
| Docker    | compose v3.8 |

---

## âœ… Ğ¢Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğº Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ

| ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° | ĞĞ¶Ğ¸Ğ´Ğ°ĞµĞ¼Ñ‹Ğ¹ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚ |
|---------|--------------------|
| Ğ’ÑĞµ Ñ„Ğ¸Ğ»ÑŒĞ¼Ñ‹ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹ | `GET /api/afisha/films` â†’ JSON |
| Ğ Ğ°ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ Ğ½Ğµ Ğ¿ÑƒÑÑ‚Ğ¾Ğµ | `GET /api/afisha/films/:id/schedule` â†’ Ğ¼Ğ°ÑÑĞ¸Ğ² ÑĞµĞ°Ğ½ÑĞ¾Ğ² |
| Ğ‘Ñ€Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ | `POST /order` â†’ ÑƒÑĞ¿ĞµÑˆĞ½Ñ‹Ğ¹ Ğ¾Ñ‚Ğ²ĞµÑ‚ |
| ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ° PostgreSQL / MongoDB | âœ”ï¸ DATABASE_DRIVER=postgres / mongodb |
| DTO Ğ¸ Ğ¼Ğ°Ğ¿Ğ¿ĞµÑ€Ñ‹ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ÑÑ‚ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾ | âœ”ï¸ |
| Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ĞºĞ° Ğ¾Ñ‚Ğ´Ğ°Ñ‘Ñ‚ÑÑ Ñ‡ĞµÑ€ĞµĞ· `/public` | âœ”ï¸ `/content/afisha` |

---

## ğŸ“ ĞŸĞ¾Ğ»ĞµĞ·Ğ½Ñ‹Ğµ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹

| Ğ§Ñ‚Ğ¾? | ĞšĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ° |
|------|--------|
| Ğ—Ğ°Ğ¿ÑƒÑĞº Ñ‡ĞµÑ€ĞµĞ· Docker | `docker-compose up -d` |
| ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ¾Ğ² | `docker-compose down` |
| Ğ›Ğ¾Ğ³Ğ¸ Ğ±ÑĞºĞµĞ½Ğ´Ğ° | `docker logs film-backend` |
| Ğ›Ğ¾Ğ³Ğ¸ Postgres | `docker logs prac-postgres` |
| Ğ’Ğ¾Ğ¹Ñ‚Ğ¸ Ğ² Ğ‘Ğ” | `docker exec -it prac-postgres psql -U prac -d prac` |
| Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Postman-Ñ‚ĞµÑÑ‚Ñ‹ | `newman run films.postman.json` |
| ĞŸĞ¾ÑĞ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ² MongoDB | `docker exec -it film-mongo mongosh afisha` |

---

## ğŸ“Œ Ğ›Ğ¸Ñ†ĞµĞ½Ğ·Ğ¸Ñ

MIT License â€” Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ ÑĞ²Ğ¾Ğ±Ğ¾Ğ´Ğ½Ğ¾!

---

## ğŸ‘¨â€ğŸ’» ĞĞ²Ñ‚Ğ¾Ñ€

ĞĞ»ĞµĞºÑĞ°Ğ½Ğ´Ñ€ Ğ’ĞµĞ½ĞµĞ´ÑÑ…Ğ¸Ğ½  
Yandex.Practicum, ĞºÑƒÑ€Ñ Â«Node.jsÂ»
